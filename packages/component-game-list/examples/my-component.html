<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Component - Example page</title>
  <!-- CSS only -->
  <script
    src="https://unpkg.com/react@17/umd/react.production.min.js"
    crossorigin
  ></script>
  <script
    src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"
    crossorigin
  ></script>

  <link
    rel="stylesheet"
    href="https://unity.web.asu.edu/@asu/bootstrap4-theme/css/bootstrap-asu.css"
  />
  <link
    rel="stylesheet"
    href="https://asu.github.io/asu-unity-stack/@asu/unity-bootstrap-theme/css/unity-bootstrap-theme.bundle.css"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/brands.min.css"
    integrity="sha512-DJLNx+VLY4aEiEQFjiawXaiceujj5GA7lIY8CHCIGQCBPfsEG0nGz1edb4Jvw1LR7q031zS5PpPqFuPA8ihlRA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/regular.min.css"
    integrity="sha512-KYEnM30Gjf5tMbgsrQJsR0FSpufP9S4EiAYi168MvTjK6E83x3r6PTvLPlXYX350/doBXmTFUEnJr/nCsDovuw=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/solid.min.css"
    integrity="sha512-Hp+WwK4QdKZk9/W0ViDvLunYjFrGJmNDt6sCflZNkjgvNq9mY+0tMbd6tWMiAlcf1OQyqL4gn2rYp7UsfssZPA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/js/all.min.js"
    integrity="sha512-u3fPA7V8qQmhBPNT5quvaXVa1mnnLSXUep5PS1qo5NRzHwG19aHmNJnj1Q8hpA/nBWZtZD4r4AX6YOt5ynLN2g=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  ></script>
  <!-- *************************************************************** -->
  <!-- include bundled scripts from packages -->
  <script src="../dist/GameListComponent.umd.js"></script>
  <script src="../dist/vendor.umd.js"></script>
</head>

<body>
<!-- Provide target divs for the component. Must have unique ids or class name. -->
<div class="container">
  <div class="mt-2" id="example-wrapper"></div>
  <div class="mt-4" id="example-wrapper-football"></div>
</div>

<script>
  // Function to fetch data from the API
  async function getEndpoint() {
    const url = 'https://asuevents.asu.edu/feed-json/sun_devil_athletics';

    try {
      const response = await fetch(url, {
        method: 'GET',
      });

      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }

      const data = await response.json();
      const mappedData = mapResponseToDesiredFormat(data);
      const allSports = [
        {
          name: "All Sports",
          icon: "fas fa-sync-alt",
          active: true,
          position: 1,
          id: "all",
        },
        {
          name: "Football",
          icon: "fas fa-football-ball",
          position: 2,
          id: "football",
        },
        {
          name: "M. Basketball",
          icon: "fas fa-basketball-ball",
          position: 3,
          id: "basketball",
        },
        {name: "Hockey", icon: "fas fa-hockey-puck", position: 4, id: "hockey"},
        {
          name: "Baseball",
          icon: "fas fa-baseball-ball",
          position: 5,
          id: "baseball",
        },
        {
          name: "W. Basketball",
          icon: "fas fa-basketball-ball",
          id: "w-basketball",
        },
        {name: "Softball", icon: "fas fa-futbol", id: "softball"},
        {name: "Soccer", icon: "fas fa-baseball-ball", id: "soccer"},
        {name: "Swimming", icon: "fas fa-swimmer", id: "swimming"},
        {name: "Golf", icon: "fas fa-golf-ball", id: "golf"},
      ];
      initGameListComponent({
          targetSelector: '#example-wrapper',
          props: {
            games: mappedData,
            sports: allSports,
            title: "Upcoming games",
            invertColor: false,
            sponsorBlock: {
              text: "Presented By",
              name: "Ford",
              logo: "https://upload.wikimedia.org/wikipedia/commons/3/3e/Ford_logo_flat.svg",
              url: "https://www.ford.com/",
            },
            footerButtons: [
              {
                color: "gold",
                label: "Full schedule",
                size: "small",
                link: "https://www.example.com",
              },
              {
                color: "maroon",
                label: "Gear up for the game",
                size: "small",
                link: "https://www.example.com",
              },
            ],
          },
        })
      initGameListComponent({
          targetSelector: '#example-wrapper-football',
          props: {
            games: mappedData,
            sports: [],
            tabs: [
              { label: "All Games", active: true, id: "all" },
              { label: "Home", active: false, id: "home" },
              { label: "Away", active: false, id: "away" },
            ],
            title: "Upcoming games",
            subtitle: "From the fall football season to the Maroon and Gold Spring game and at Camp Tontozona,\n" +
              "        there are football games and events throughout the year.",
            invertColor: false,
            footerButtons: [
              {
                color: "gold",
                label: "Full schedule",
                size: "small",
                link: "https://www.example.com",
              },
              {
                color: "maroon",
                label: "Gear up for the game",
                size: "small",
                link: "https://www.example.com",
              },
            ],
          },
        })
    } catch
      (error) {
      console.error('There was a problem with the fetch operation:', error);
    }
  }

  // Mapper function to transform the API response to the desired JSON format
  function mapResponseToDesiredFormat(apiResponse) {
    return apiResponse.nodes.map(node => {
      const event = node.node;
      const [monthDay, yearTime] = event.start_date.split(' - ');
      const [month, day] = monthDay.split(' ');

      return {
        date: {
          day: day,
          month: month
        },
        sport: {
          name: event.sport_tag || "Sport Name",
          icon: "fa fa-rocket"  // Assuming a static icon for all sports
        },
        homeTeam: {
          name: event.title,
        },
        ticketLink: event.ticketing_rsvp_url || "https://www.example.com",
        ticketText: event.ticketing_rsvp_txt || "Buy Tickets",
        time: yearTime || "TBD",
        venue: event.locations || "Venue Name",
        gameType: event.game_type || "home",
      };
    });
  }

  // Call the function
  getEndpoint();
</script>
<script src="./js/index.js"></script>
</body>
</html>
